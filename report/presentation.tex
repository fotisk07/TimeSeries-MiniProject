\documentclass{beamer}
\usetheme{Madrid}
\usecolortheme{default}
\useoutertheme{split}
\useinnertheme{circles}
\usepackage{xcolor}
\usepackage{mathrsfs}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{animate}
\usepackage{caption}
\captionsetup[figure]{font=tiny}

\usepackage[
    backend=biber,
    style=alphabetic,
    sorting=ynt
]{biblatex}
\addbibresource{bib.bib}

\usepackage{bbm}

% --- Couleurs CS ---
\definecolor{CSred}{RGB}{160,32,60}
\definecolor{CSgrey}{RGB}{136,121,150}
\definecolor{UPSred}{RGB}{97,21,58}
\setbeamercolor{titlelike}{bg=CSred}
\setbeamerfont{title}{series=\bfseries}
\setbeamercolor{palette primary}{bg=CSred,fg=white}
\setbeamercolor{palette secondary}{bg=CSred,fg=white}
\setbeamercolor{palette tertiary}{bg=CSgrey,fg=white}
\setbeamercolor{palette quaternary}{bg=CSgrey,fg=white}
\setbeamercolor{structure}{fg=CSgrey}

\title[Time Series]{Machine Learning for Time Series}
\subtitle{Presentation - Mini-Project}
\author[Jamal, Kapotos]{Adonis~JAMAL \and Fotios~KAPOTOS\\SoccerCPD: Formation and Role Change-Point Detection in Soccer Matches Using Spatiotemporal Tracking Data}
\institute[ENS Paris-Saclay]{Ecole Normale Sup√©rieure Paris-Saclay - MVA}
\date[December 17th 2025]{December 17th 2025}

\titlegraphic{
    \includegraphics[height=1.2cm]{img/logo_mva.jpg}
}

\begin{document}

\frame{\titlepage}


% ==============================================================================
% SECTION : INTRODUCTION
% ==============================================================================
\section{Introduction}
\begin{frame}{Context and Problem Statement}
    \begin{itemize}
        \item \textbf{Context:} Analyzing team formation is crucial for interpreting tactics in fluid sports like soccer.
        \item \textbf{The Challenge:} Tracking data is noisy; players frequently switch positions temporarily.
        \item \textbf{Limitation of existing methods:} Often assume constant formations or react too sensitively to frame-by-frame noise.
        \item \textbf{Objective:} Reproduce and extend \textbf{SoccerCPD} \cite{Kim2022SoccerCPD}, an unsupervised framework that distinguishes:
        \begin{itemize}
            \item \textbf{FormCPD:} Shifts in global spatial configuration.
            \item \textbf{RoleCPD:} Long-term tactical changes in individual roles.
        \end{itemize}
    \end{itemize}
\end{frame}

% ==============================================================================
% SECTION : WORK DONE
% ==============================================================================
\section{Work Done \& Contributions}
\begin{frame}{Work Repartition and Contributions}
    \begin{columns}
        \begin{column}{0.6\textwidth}
            \textbf{Work Repartition}
            \begin{itemize}
                \item \textbf{FormCPD:} Implementation of Delaunay-based adjacency and formation change detection.
                \item \textbf{RoleCPD:} Synthetic role data generation, permutation analysis, and recursive segmentation.
            \end{itemize}
            
            \vspace{0.3cm}
            \textbf{Implementation \& Extensions}
            \begin{itemize}
                \item Python package with R-backend for g-segmentation.
                \item \textbf{Novel Experiment:} "Player Stationarity" metric.
                \item \textbf{Refinement:} Possession Context analysis.
            \end{itemize}
        \end{column}
        \begin{column}{0.4\textwidth}
            \centering
            % Visualizing the concept of roles vs players
            \includegraphics[width=\linewidth]{../figures/role_swap.png}
            \captionof{figure}{Role vs Player coloring}
        \end{column}
    \end{columns}
\end{frame}

% ==============================================================================
% SECTION : METHODOLOGY
% ==============================================================================
\section{Methodology}

\begin{frame}{Methodology: FormCPD (1/2)}
    \framesubtitle{Role Assignment and Spatial Structure}
    
    \begin{columns}
        \begin{column}{0.6\textwidth}
            \textbf{1. Role Assignment}
            \begin{itemize}
                \item Players assigned latent spatial roles via constrained EM.
            \end{itemize}
        
            \textbf{2. Delaunay Triangulation}
            \begin{itemize}
                \item Encodes local spatial relationships.
                \item Produces binary role-adjacency matrix $A(t)$ invariant to permutations.
                \item Emphasizes \emph{topological structure}.
            \end{itemize}
        \end{column}
        \begin{column}{0.4\textwidth}
            \centering
            \includegraphics[width=\linewidth]{../figures/delany_form_change.png}
            \captionof{figure}{Delaunay Triangulation reconfiguration}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}{Methodology: FormCPD (2/2)}
    \framesubtitle{Change-Point Detection and Adjacency}
    
    \begin{columns}
        \begin{column}{0.5\textwidth}
            \textbf{3. Discrete g-segmentation}
            \begin{itemize}
                \item Applied to adjacency sequence $\{A(t)\}$.
                \item Distance: $d_M(A(t), A(t')) = \|A(t)-A(t')\|_{1,1}$.
                \item Constraints: $p < 0.01$, min duration 5 min.
            \end{itemize}
        \end{column}
        \begin{column}{0.5\textwidth}
            \centering
            \includegraphics[width=0.9\linewidth]{../figures/A_mean.png}
            \captionof{figure}{Mean Adjacency Matrices}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}{Methodology: RoleCPD}
    \framesubtitle{Detecting Intraphase Tactical Shifts}
    
    \begin{columns}
        \begin{column}{0.6\textwidth}
            \begin{itemize}
                \item \textbf{Goal:} Detect permanent role swaps within stable formation.
                \item \textbf{Metric:} Normalized Hamming Distance (Switch Rate):
                $$d(\pi_t, \pi_{t'}) = \frac{1}{N} \sum_{p \in P} \mathbbm{1}_{\pi_t(X_p) \neq \pi_{t'}(X_p)}$$
                \item \textbf{Process:}
                \begin{enumerate}
                    \item Preprocessing: Exclude Switch Rate $>0.7$.
                    \item Recursive g-segmentation.
                \end{enumerate}
            \end{itemize}
        \end{column}
        \begin{column}{0.4\textwidth}
            \centering
            \includegraphics[width=\linewidth]{../figures/RoleCPD_DetectedPhases.png}
            \captionof{figure}{Recovered Tactical Phases}
        \end{column}
    \end{columns}
\end{frame}

% ==============================================================================
% SECTION : DATA
% ==============================================================================
\section{Data Analysis}
\begin{frame}{Data Sources and Diagnosis}
    \begin{columns}
        \begin{column}{0.5\textwidth}
            \textbf{High-Frequency Tracking (GPS)}
            \begin{itemize}
                \item SkillCorner (10Hz) \& Last Row (20Hz).
                \item Clean signals, suitable for Gaussian assumptions.
            \end{itemize}
        
            \textbf{Event-Stream (StatsBomb)}
            \begin{itemize}
                \item \textbf{Challenge:} Extreme sparsity ($<10$ pts/min).
                \item \textbf{Adaptation:} Pseudo-trajectories via temporal aggregation (5-min average).
            \end{itemize}
        \end{column}
        \begin{column}{0.5\textwidth}
            \centering
            \includegraphics[width=\linewidth]{../figures/data-heatmap_comparison.png}
            \captionof{figure}{GPS vs Event Data Density}
        \end{column}
    \end{columns}
\end{frame}

% ==============================================================================
% SECTION : RESULTS
% ==============================================================================
\section{Results}

\begin{frame}{Results: Sensitivity Analysis}
    \begin{columns}
        \begin{column}{0.5\textwidth}
            \textbf{Sensitivity to \texttt{min\_fdist}}
            \begin{itemize}
                \item \texttt{min\_fdist}: Threshold for formation distance.
                \item \textbf{Observation:} Increasing threshold reduces segment count but preserves stable change-points.
                \item \textbf{Conclusion:} Acts as a pruning mechanism for minor structural variations.
            \end{itemize}
        \end{column}
        \begin{column}{0.5\textwidth}
            \centering
            \includegraphics[width=\linewidth]{../figures/exp2_cp_timeline_min_fdist.png}
            \captionof{figure}{Timeline stability under varying thresholds}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}{Extension 1: Possession Context}
    \begin{columns}
        \begin{column}{0.5\textwidth}
            \textbf{Refining Formation Analysis}
            \begin{itemize}
                \item \textbf{Limitation:} Global average ignores game state.
                \item \textbf{Method:} Filter frames (Attack vs. Defense).
                \item \textbf{Result (Match 1925299):}
                \begin{itemize}
                    \item \textbf{Defending (Left):} Compact block.
                    \item \textbf{Attacking (Right):} Wider, advanced shape.
                \end{itemize}
            \end{itemize}
        \end{column}
        \begin{column}{0.5\textwidth}
            \centering
            \includegraphics[width=\linewidth]{../figures/Experiments_AttDefFormations_1925299.png}
            \captionof{figure}{Defending vs Attacking Formations}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}{Extension 2: Player Stationarity Metric}
    \begin{columns}
        \begin{column}{0.55\textwidth}
            \textbf{Quantifying Role Fluidity}
            \begin{itemize}
                \item \textbf{Metric:} Std dev of Euclidean distance between player position and role center.
                \item \textbf{Findings (A-League):}
                \begin{itemize}
                    \item Captures variance in movement within a "stable" phase.
                    \item Distinguishes "Fixed" roles (CB) from "Roaming" roles (Wingers/Midfield).
                \end{itemize}
            \end{itemize}
        \end{column}
        \begin{column}{0.45\textwidth}
            \centering
            \includegraphics[width=\linewidth]{../figures/Experiments_Player_Stationarity_Phase1_1925299.png}
            \captionof{figure}{Player Stationarity (Phase 1)}
        \end{column}
    \end{columns}
\end{frame}

% ==============================================================================
% SECTION : CONCLUSION
% ==============================================================================
\section{Conclusion}
\begin{frame}{Conclusion}
    \begin{itemize}
        \item \textbf{Successful Reproduction:} Implemented FormCPD and RoleCPD, validating the framework on synthetic and real matches.
        \item \textbf{Robustness:} Confirmed method stability via sensitivity analysis.
        \item \textbf{Key Extensions:} 
        \begin{enumerate}
            \item \textbf{Possession Context:} Revealed distinct attacking/defensive shapes.
            \item \textbf{Stationarity Metric:} Provided quantitative insights into player role adherence.
        \end{enumerate}
        \item \textbf{Versatility:} Demonstrated applicability to sparse event-stream data.
    \end{itemize}
\end{frame}

% ==============================================================================
% SECTION : BIBLIOGRAPHY
% ==============================================================================

\begin{frame}{Bibliography}
    \printbibliography
\end{frame}

\end{document}